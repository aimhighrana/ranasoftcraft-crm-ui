<div class="root">
  <div class="f-row-spacer-half"></div>
  <div class="f-row">
    <lib-text-line type="leading">Inbox</lib-text-line>
    <span class="f-spacer"></span>
    <lib-button-group>
      <lib-button type="minor">New task</lib-button>
      <lib-button type="minor" icon="ellipsis-h"></lib-button>
    </lib-button-group>
  </div>
  <div class="f-row-spacer-half"></div>

  <div class="f-row">
    <lib-chip-list>
      <lib-search placeholder="Search tasks"></lib-search>
      <ng-container *ngFor="let chip of currentNodeFilterChips">
        <lib-chip [label]="chip.chip" [icon]="chip.icon" [type]="chip.type" [matMenuTriggerFor]="filterMenu"
          >{{ chip.type ? ': ' : '' }}{{ chip.value ? chip.value : 'All' }}</lib-chip
        >
        <mat-menu #filterMenu="matMenu" xPosition="after" (closed)="searchInput.clearSearch()">
          <lib-filter-dropdown>
            <div class="dropdown-search-wrapper">
              <lib-search #searchInput prosClickStopPropagation (valueChange)="filterModulesMenu($event, chip.chip)"></lib-search>
            </div>
            <div class="dropdown-options-wrapper f-col">
              <div class="dropdown-options-inner-container">
                <div class="default-options">
                  <lib-filter-option>
                    <lib-checkbox label="All"></lib-checkbox>
                  </lib-filter-option>
                  <div class="separator">
                    <mat-divider></mat-divider>
                  </div>
                </div>
                <div class="options">
                  <lib-filter-option
                    prosClickStopPropagation
                    (click)="setChipValue(chip, item)"
                    *ngFor="let item of filteredNodeChipsMenuItems[chip.chip]"
                  >
                    <lib-checkbox [label]="item" prosClickStopPropagation (valueChange)="setChipValue(chip, item)"></lib-checkbox>
                  </lib-filter-option>
                </div>
              </div>
              <div class="filter-button-wrapper">
                <lib-button type="minor">Apply</lib-button>
              </div>
            </div>
          </lib-filter-dropdown>
        </mat-menu>
      </ng-container>
      <lib-chip icon="filter"></lib-chip>
      <lib-chip icon="ellipsis-h"></lib-chip>
    </lib-chip-list>
  </div>
  <div class="f-row-spacer-half"></div>
  <div class="task-inbox">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      matSortActive="Records"
      matSortDisableClear
      matSortDirection="desc"
      class="mat-elevation-z0"
    >
      <!-- Checkbox Column -->
      <ng-container matColumnDef="select" sticky>
        <th mat-header-cell *matHeaderCellDef>
          <lib-checkbox
            (valueChange)="masterToggle()"
            [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()"
            [aria-label]="checkboxLabel()"
          ></lib-checkbox>
        </th>
        <td mat-cell *matCellDef="let element">
          <lib-checkbox
            (valueChange)="selection.toggle(element)"
            [checked]="selection.isSelected(element)"
            [aria-label]="checkboxLabel(element)"
          ></lib-checkbox>
        </td>
      </ng-container>

      <!-- Setting Column -->
      <ng-container matColumnDef="setting" sticky>
        <th mat-header-cell *matHeaderCellDef>
          <lib-button icon="cog" (click)="openTableViewSettings()"></lib-button>
        </th>
        <td mat-cell *matCellDef="let element">
          <lib-button-group>
            <lib-button type="minor" icon="ellipsis-h"></lib-button>
            <lib-button type="minor" iconFontType="solid" icon="star"></lib-button>
            <lib-button type="minor" icon="comment-alt"></lib-button>
          </lib-button-group>
        </td>
      </ng-container>

      <!-- Records Column -->
      <ng-container matColumnDef="Records" sticky>
        <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Records</th>
        <td mat-cell *matCellDef="let element"><lib-text-line type="base" textColor="link">1209876</lib-text-line></td>
      </ng-container>

      <!-- dynamic columns -->
      <ng-template ngFor let-dynCol [ngForOf]="displayedColumns">
        <ng-template [ngIf]="isStaticCol(dynCol)" [ngIfElse]="dynamic"> </ng-template>
        <ng-template #dynamic>
          <ng-container [matColumnDef]="dynCol">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ getFieldDesc(dynCol) }}
            </th>
            <td mat-cell *matCellDef="let element">
              {{ element[dynCol] ? element[dynCol] : '' }}
            </td>
          </ng-container>
        </ng-template>
      </ng-template>

      <!-- Description Column -->
      <!-- <ng-container matColumnDef="description">
				<th mat-header-cell *matHeaderCellDef>Description</th>
				<td mat-cell *matCellDef="let element">
					<lib-text-line type="base" weight="strong">Approval for new material</lib-text-line>
				</td>
			</ng-container> -->

      <!-- Sent by Column -->
      <!-- <ng-container matColumnDef="sentby">
				<th mat-header-cell *matHeaderCellDef>Sent by</th>
				<td mat-cell *matCellDef="let element">
					<lib-avatar class="lib-avatar"></lib-avatar>
				</td>
			</ng-container> -->

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns" (click)="selection.toggle(row)"></tr>
    </table>
  </div>

  <div class="f-row-spacer-half"></div>
  <div class="pagination-section">
    <lib-pagination
      [currentPageIndex]="pageEvent.pageIndex"
      [totalCount]="pageEvent.length"
      [pageSize]="pageEvent.pageSize"
      (pageChangeEvent)="onPageChange($event)"
    >
    </lib-pagination>
  </div>
</div>
