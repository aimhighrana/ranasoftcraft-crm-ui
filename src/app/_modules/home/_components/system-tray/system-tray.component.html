<div class="root">
    <div class="f-row breadcrum-toolbar">
        <lib-button (click)="close()">
            <mat-icon fontSet="mdo-icons">times</mat-icon>
        </lib-button>
        <div class="col-spacer"></div>
        <div class="f-col mdo-constrained-right">
            <div class="f-row breadcrum-head">
                <div i18n="@@system_tray" class="display-heading-large">System tray</div>
            </div>
        </div>
    </div>

    <div class="f-col sidesheetcontent-listing">
        <lib-tab-group disableRipple="true" #matTabgroup>
            <lib-tab i18n-label="@@notifications" label="Notifications">
                <mat-nav-list>
                    <mat-list-item *ngFor="let notification of notifications;">
                        <div class="f-col notification-listing">
                            <div mat-line>{{notification.headerText}}</div>
                            <div class="f-row notify-row">
                                <div class="f-row notify-message-row">
                                    <ng-template [ngIf]="!notification.showMore" [ngIfElse]= "withoutTruncate">
                                        <div class="notify-content" >
                                            <p>{{notification.contentText}}</p>
                                            <a (click)="download(notification.downloadLink)">{{notification.downloadLink}}</a>
                                        </div>
                                        <a *ngIf="(notification.downloadLink && notification.downloadLink.length > 96)|| (notification.contentText && notification.contentText.length > 96)" (click)="notification.showMore = !notification.showMore">
                                            <mat-icon fontSet="mdo-icons" class="mat-expand-icon">chevron-right</mat-icon>
                                        </a>
                                    </ng-template>
                                   
                                    <ng-template  #withoutTruncate>
                                        <div class="notify-content expand-content">
                                            <p class="collapse-text">{{notification.contentText}}</p>
                                            <a (click)="download(notification.downloadLink)">{{notification.downloadLink}}</a>
                                        </div>
                                        <a *ngIf="(notification.downloadLink && notification.downloadLink.length > 96) || (notification.contentText && notification.contentText.length > 96)" (click)="notification.showMore = !notification.showMore">
                                            <mat-icon fontSet="mdo-icons" class="mat-expand-icon">chevron-down</mat-icon>
                                        </a>
                                    </ng-template>
 
                                </div>
                                <span class="f-spacer"></span>
                                <div class="f-row">
                                    <mat-card-header>
                                        <ng-template [ngIf]="notification.senderUid || notification.senderMail" [ngIfElse]="showUserProfile">
                                            <mat-card-header>
                                                <lib-avatar [initials]="notification.senderUid ? notification.senderUid[0] : notification.senderMail[0]"></lib-avatar>
                                            </mat-card-header>
                                        </ng-template>
            
                                        <ng-template #showUserProfile>
                                            <mat-card-header>
                                                <div mat-card-avatar>
                                                    <mat-icon fontSet="mdo-icons">home-channel2</mat-icon>
                                                </div>
                                            </mat-card-header>
                                        </ng-template>
                                    </mat-card-header>
                                    <span class="f-col-spacer-half"></span>
                                    <lib-button (click)="deleteNotification(notification.id)"
                                        prosClickStopPropagation>
                                        <mat-icon fontSet="mdo-icons">trash-alt</mat-icon>
                                    </lib-button>
                                </div>
                            </div>
                            <p class="notify-content" disableRipple="true">{{notification.sendTime | date:"dd MMM hh:mm:ss" }}</p>
                        </div>

                    </mat-list-item>
                </mat-nav-list>
            </lib-tab>

            <lib-tab label="Job query" [badgeCount]="jobQueueData.length">
                <mat-nav-list>
                    <mat-list-item *ngFor="let job of jobQueueData">
                        <div mat-line class="job-line">{{job.logMessage}}</div>
                        <span class="f-spacer"></span>
                        <mat-chip-list>
                            <mat-chip disableRipple="true" *ngIf="job.jobPk.status === 'IN_PROGRESS'" class="success-status">
                                <mat-spinner diameter="14"></mat-spinner>&nbsp;Running
                            </mat-chip>
                            <mat-chip disableRipple="true" *ngIf="job.jobPk.status === 'COMPLETE'" class="unselected">
                                <mat-icon fontSet="mdo-icons" class="time-icon">clock</mat-icon>&nbsp;{{
                                job.startDate | date:'dd-MMM-yyyy hh:mm:ss' }}
                            </mat-chip>
                        </mat-chip-list>
                        <span class="col-spacer"></span>
                        <mat-card-header>
                            <lib-avatar [initials]="job.initiatedBy"></lib-avatar>
                        </mat-card-header>
                        <span class="col-spacer"></span>
                        <lib-button>
                            <mat-icon fontSet="mdo-icons">ellipsis-h</mat-icon>
                        </lib-button>
                    </mat-list-item>
                </mat-nav-list>
            </lib-tab>
        </lib-tab-group>
    </div>
</div>