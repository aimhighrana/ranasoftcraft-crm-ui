<div class="root">
    <div class="f-row breadcrum-toolbar">
        <lib-button (click)="close()" icon="times" type="plain" iconFontType="light"></lib-button>
        <div class="col-spacer"></div>
        <div class="f-col mdo-constrained-right">
            <div class="f-row breadcrum-head">
                <lib-text-line i18n="@@system_tray" type="headline">System tray</lib-text-line>
            </div>
        </div>
    </div>

    <div class="f-col sidesheetcontent-listing">
        <lib-tab-group disableRipple="true" #matTabgroup class="lib-tab">
            <lib-tab i18n-label="@@notifications" label="Notifications">
                <mat-nav-list>
                    <mat-list-item *ngFor="let notification of notifications;">
                        <div class="f-row notification-listing">
                            <div class="f-col notify-row">
                                <ng-template [ngIf]="!notification.showMore" [ngIfElse]="withoutTruncate">
                                    <lib-text-line type="base" weight="strong">{{notification.headerText}}
                                    </lib-text-line>
                                    <lib-text-line type="xsmall" enableWrap="true">{{notification.contentText}}
                                    </lib-text-line>
                                    <lib-text-line type="xsmall" enableWrap="true"
                                        (click)="download(notification.downloadLink)">
                                        {{notification.downloadLink}}</lib-text-line>
                                    <a *ngIf="(notification.downloadLink && notification.downloadLink.length > 96)|| (notification.contentText && notification.contentText.length > 96)"
                                        (click)="notification.showMore = !notification.showMore">
                                        <mat-icon fontSet="mdo-icons" class="mat-expand-icon">chevron-right
                                        </mat-icon>
                                    </a>
                                    <lib-text-line type="xsmall" enableWrap="true">{{notification.sendTime | date:"dd
                                        MMM
                                        hh:mm:ss" }}
                                    </lib-text-line>
                                </ng-template>
                                <ng-template #withoutTruncate>
                                    <div class="notify-content expand-content">
                                        <lib-text-line type="xsmall">{{notification.contentText}}</lib-text-line>
                                        <lib-text-line type="xsmall" (click)="download(notification.downloadLink)">
                                            {{notification.downloadLink}}</lib-text-line>
                                    </div>
                                    <a *ngIf="(notification.downloadLink && notification.downloadLink.length > 96) || (notification.contentText && notification.contentText.length > 96)"
                                        (click)="notification.showMore = !notification.showMore">
                                        <mat-icon fontSet="mdo-icons" class="mat-expand-icon">chevron-down
                                        </mat-icon>
                                    </a>
                                </ng-template>
                            </div>
                            <div class="f-row">
                                <mat-card-header>
                                    <ng-template [ngIf]="notification.senderUid || notification.senderMail"
                                        [ngIfElse]="showUserProfile">
                                        <mat-card-header>
                                            <lib-avatar
                                                [initials]="notification.senderUid ? notification.senderUid[0] : notification.senderMail[0]">
                                            </lib-avatar>
                                        </mat-card-header>
                                    </ng-template>

                                    <ng-template #showUserProfile>
                                        <mat-card-header>
                                            <div mat-card-avatar>
                                                <mat-icon fontSet="mdo-icons">home-channel2</mat-icon>
                                            </div>
                                        </mat-card-header>
                                    </ng-template>
                                </mat-card-header>
                                <span class="f-col-spacer-half"></span>
                                <lib-button (click)="deleteNotification(notification.id)" type="plain" icon="trash-alt"
                                    prosClickStopPropagation></lib-button>
                            </div>
                        </div>
                    </mat-list-item>
                </mat-nav-list>
            </lib-tab>

            <lib-tab label="Job queue" [badgeCount]="jobQueueData.length">
                <mat-nav-list>
                    <mat-list-item *ngFor="let job of jobQueueData">
                        <lib-text-line type="base" class="job-line" enableWrap="true">{{job.logMessage}}</lib-text-line>
                        <span class="f-spacer"></span>
                        <lib-chip-list class="mdo-chip-list">
                            <lib-label class="job-date" status="success" *ngIf="job.jobPk.status === 'IN_PROGRESS'">
                                <lib-spinner size="18"></lib-spinner>&nbsp;Running
                            </lib-label>
                            <lib-chip class="job-date" *ngIf="job.jobPk.status === 'COMPLETE'">
                                <mat-icon fontSet="mdo-icons" class="time-icon">clock</mat-icon>&nbsp;{{
                                job.startDate | date:'dd-MMM-yyyy hh:mm:ss' }}
                            </lib-chip>
                        </lib-chip-list>
                        <span class="col-spacer"></span>
                        <mat-card-header>
                            <lib-avatar [initials]="job.initiatedBy"></lib-avatar>
                        </mat-card-header>
                        <span class="col-spacer"></span>
                        <lib-button type="plain" icon="ellipsis-h"></lib-button>
                    </mat-list-item>
                </mat-nav-list>
            </lib-tab>
        </lib-tab-group>
    </div>
</div>