<div class="root">
  <mat-card class="secondary-card mat-elevation-z0">
    <div class="row-spacer"></div>
    <div class="f-row display-heading-large">
      <div>{{ getRoutedDescription }}</div>
      <span class="f-spacer"></span>
      <button mat-button (click)="globalCreate()">
        <mat-icon fontSet="mdo-icons">plus</mat-icon>
      </button>
      
    </div>
    <div class="row-spacer"></div>

    <pros-search-input [placeholder]="activatedPrimaryNav ==='report' ? 'Search report' : 'Search Schema'" (value)=(searchSchema($event))></pros-search-input>

    <div class="row-spacer"></div>

    <div class="nav-tree">
      <mat-accordion *ngIf="activatedPrimaryNav === 'welcome'">
        <ng-container *ngFor="let module of searchModuleResults">
          <mat-expansion-panel togglePosition="before" class="mat-elevation-z0"
            *ngIf="module.schemaLists && module.schemaLists.length>0">
            <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px">
              <mat-panel-title>
                <div class="expand-title">{{module.moduleDesc ? module.moduleDesc : 'Untitled'}}</div>
                <span class="f-spacer"></span>
                <div class="badge">{{module.schemaLists.length}}</div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-nav-list role="navigation">
              <mat-list-item *ngFor="let schema of module.schemaLists"
                [routerLink]="['schema/schema-details', module.moduleId, schema.schemaId]"
                [routerLinkActive]="'selected'">
                <div mat-line>{{schema.schemaDescription ?  schema.schemaDescription : 'Untitled'}}</div>
              </mat-list-item>
            </mat-nav-list>
          </mat-expansion-panel>
          </ng-container>
      </mat-accordion>
      
      <mat-accordion *ngIf="activatedPrimaryNav === 'schema'">
        <div class="section-header">
          Data intelligence
        </div>
        <div class="row-spacer"></div>
        <ng-container *ngFor="let module of searchModuleResults">
          <mat-expansion-panel togglePosition="before" class="mat-elevation-z0"
            *ngIf="module.schemaLists && module.schemaLists.length>0">
            <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px"
              [routerLink]="['schema', module.moduleId]">
              <mat-panel-title>
                <div class="expand-title">{{module.moduleDesc ? module.moduleDesc : 'Untitled'}}</div>
                <span class="f-spacer"></span>
                <div class="badge">{{module.schemaLists.length}}</div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-nav-list role="navigation">
              <mat-list-item *ngFor="let schema of module.schemaLists"
                [routerLink]="['schema/schema-info', schema.moduleId, schema.schemaId]"
                [queryParams]="{fragment:'business-rules'}">
                <div mat-line>{{schema.schemaDescription ?  schema.schemaDescription : 'Untitled'}}</div>
              </mat-list-item>
            </mat-nav-list>
          </mat-expansion-panel>
        </ng-container>
      </mat-accordion>

      <mat-accordion *ngIf="activatedPrimaryNav === 'report'">
        <mat-nav-list *ngFor="let report of reportOb | async">
          <mat-list-item [disabled]="report.permission && !report.permission.isViewable"
            [routerLink]="['report/dashboard', report.reportId]" [routerLinkActive]="'selected'">
            <div class="heading-title">{{report.reportName ? report.reportName : 'Untitled'}}</div>
          </mat-list-item>
        </mat-nav-list>
      </mat-accordion>
    </div>
  </mat-card>

  <div class="split-col mat-elevation-z1" (click)="toggleSideBar()">
    <mat-icon class="split-arrow">{{arrowIcon}}</mat-icon>
  </div>
</div>