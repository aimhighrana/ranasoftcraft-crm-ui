<mat-card class="mat-elevation-z0 widget">
  <div class="f-row breadcrum-toolbar">
    <div class="display-heading-large">
      {{ widgetInf.getValue() ? widgetInf.getValue().desc : 'Timeseries widget' }}
    </div>
    <span class="f-spacer"></span>
    <lib-button [matMenuTriggerFor]="menu" type="plain" icon="ellipsis-h"></lib-button>
    <mat-menu #menu="matMenu" class="navigation-menu">
      <button mat-menu-item (click)="downloadImage()">Image download (.png)</button>
      <button mat-menu-item (click)="downloadCSV()">Data download (.csv)</button>
      <!-- <button mat-menu-item [matMenuTriggerFor]="tcOptionMenu" i18n="@@viewAs">View as...</button> -->
      <mat-menu #tcOptionMenu="matMenu">
        <lib-radio-group layout="vertical" [(value)]="displayCriteriaOption" [options]="displayCriteriaOptions" (valueChange)="saveDisplayCriteria()" name="displayCriteria{{widgetId}}"></lib-radio-group>
      </mat-menu>
      <!-- <button mat-menu-item (click)="openColorPalette()">Color palette</button> -->
    </mat-menu>
  </div>
  <div class="row-spacer"></div>
  <mat-card-content *ngIf="chartType">
    <ng-template [ngIf]="showFilterOption">
      <div class="f-row datafilter">

        <button *ngFor="let dateType of dateFilters" mat-stroked-button [color]="dateType.isActive ? 'primary' : '' "
          (click)="updateForm('date',dateType)">{{ dateType.value === 'millisecond' ? 'Today' : dateType.value}}
          <ng-template [ngIf] = "dateType.value !== 'millisecond'">
            {{ timeseriesData.timeSeries ? timeseriesData.timeSeries.seriesWith : ''}}s
          </ng-template>
        </button>   
      <div>
          <mat-form-field appearance="outline">
            <mat-date-range-input [rangePicker]="picker">
              <input matStartDate placeholder="Start date" [formControl]="startDateCtrl">
              <input matEndDate placeholder="End date" [formControl]="endDateCtrl">
            </mat-date-range-input>
            <div class="f-row input-actions">
              <mat-divider [vertical]="true"></mat-divider>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-date-range-picker #picker></mat-date-range-picker>
            </div>
          </mat-form-field>
        </div>

      </div>
    </ng-template>


    <ng-template [ngIf]="!isGroupByChart" [ngIfElse]="groupTimeSeries">
      <canvas [height]="widgetInfo.height * boxSize" [width]="widgetInfo.width * boxSize" baseChart [datasets]="dataSet"
        class="inner-flexcol-12" [labels]="dataSetlabel" [options]="timeSeriesOption" [plugins]="lineChartPlugins"
        [chartType]="chartType">
      </canvas>
    </ng-template>
    <ng-template #groupTimeSeries>
      <canvas [height]="widgetInfo.height * boxSize" [width]="widgetInfo.width * boxSize" baseChart [datasets]="dataSet"
        class="inner-flexcol-12" [labels]="dataSetlabel" [options]="timeSeriesOption" [plugins]="lineChartPlugins"
        [chartType]="chartType">
      </canvas>
    </ng-template>
  </mat-card-content>
</mat-card>