<div class="root">

	<!-- BREADCRUMB-->
	<div class="breadcrumb-wrapper">
		<pros-breadcrumb [crumbs]="breadcrumb"></pros-breadcrumb>
    </div>
    
    <mat-card class="mat-elevation-z3 builder-container">
        <mat-toolbar class="builder-toolbar">
            <mat-toolbar-row>
                <mat-form-field class="fieldtoolbar">
                    <mat-label>Dashboard Name</mat-label>
                    <input type="text" matInput placeholder="Untitled-1" [(ngModel)]="reportName">
                    <button mat-button matSuffix mat-icon-button>
                        <mat-icon>edit</mat-icon>
                      </button>
                </mat-form-field>

                <span class="f-spacer"></span>

                <button mat-flat-button color="primary" (click)="createUpdateReport()">Save Changes</button>

                <span class="f-col-spacer-half"></span>
                <mat-button-toggle-group>
                <mat-button-toggle>
                    <mat-icon>zoom_out_map</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle>
                    <mat-icon>chrome_reader_mode</mat-icon>
                </mat-button-toggle>
                </mat-button-toggle-group>
            </mat-toolbar-row>
        </mat-toolbar>

        <div class="f-row container-row">
            <mat-card class="mat-elevation-z0 widget-col">
                <mat-card-content>
                    <mat-accordion>
                        <mat-expansion-panel class="mat-elevation-z2" expanded="true">
                          <mat-expansion-panel-header>
                            <mat-panel-title>
                              New Widget
                            </mat-panel-title>
                          </mat-expansion-panel-header>
                          <mat-list role="list" cdkDropList cdkDropListConnectedTo="container">
                            <mat-list-item role="listitem" cdkDrag widgetType="FILTER">Filters</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="COUNT">Count</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="TABLE_LIST">Table List</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="BAR_CHART">Bar Chart</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="STACKED_BAR_CHART">Stacked Bar Chart</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="IMAGE">Image</mat-list-item>
                            <mat-divider></mat-divider>
                            <mat-list-item role="listitem" cdkDrag widgetType="HTML">Html Editor</mat-list-item>
                          </mat-list>

                        </mat-expansion-panel>
                    </mat-accordion>
                    <mat-accordion>
                        <mat-expansion-panel class="mat-elevation-z2">
                            <mat-expansion-panel-header>
                              <mat-panel-title>
                                Available Widget
                              </mat-panel-title>
                            </mat-expansion-panel-header>
                            <p>Coming soon...</p>
                          </mat-expansion-panel>
                    </mat-accordion>
                </mat-card-content>  
            </mat-card>

            <mat-card class="mat-elevation-z0 container-show builder-board" [class.adjust-property] ="showProperty"  id="container" cdkDragBoundary cdkDropList (cdkDropListDropped)="drop($event)">
                <ng-template ngFor let-widget [ngForOf]="widgetList">
                    <pros-dynamic-widget
                    [widget]="widget"
                    [boxSize]="eachBoxSize"
                    (evtDelete)="delete($event)"
                    (evtStyle) ="showStyle($event)"
                    >
                    </pros-dynamic-widget>
                </ng-template>
                
                    <!-- <mat-card class="mat-elevation-z4 widget count-box">
                        <mat-toolbar-row class="widgettoolbar">
                            <h3 class="mat-h3">Count Widget</h3>
                            <span class="f-spacer"></span>
                            <button mat-icon-button>
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-toolbar-row>
                        <mat-card-content>
                          Content
                        </mat-card-content>
                    </mat-card>

                    <mat-card class="mat-elevation-z4 widget filter-box">
                        <mat-toolbar-row class="widgettoolbar">
                            <h3 class="mat-h3">Filter Widget</h3>
                            <span class="f-spacer"></span>
                            <button mat-icon-button>
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-toolbar-row>
                        <mat-card-content>content</mat-card-content>
                    </mat-card>

                    <mat-card class="mat-elevation-z4 widget bar-box">
                        <mat-toolbar-row class="widgettoolbar">
                            <h3 class="mat-h3">Bar Chart Widget</h3>
                            <span class="f-spacer"></span>
                            <button mat-icon-button>
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-toolbar-row>
                        <mat-card-content>content</mat-card-content>
                    </mat-card>

                    <mat-card class="mat-elevation-z4 widget table-box">
                        <mat-toolbar-row class="widgettoolbar">
                            <h3 class="mat-h3">Table List Widget</h3>
                            <span class="f-spacer"></span>
                            <button mat-icon-button>
                                <mat-icon>delete</mat-icon>
                            </button>
                        </mat-toolbar-row>
                        <mat-card-content>
                        Content
                        </mat-card-content>
                    </mat-card> -->
                
            </mat-card>

            <mat-card class="mat-elevation-z0 property-col" *ngIf="showProperty">
                <mat-toolbar class="c-toolbar-row">
                    <mat-toolbar-row>
                      <h3 class="mat-h3">{{ selStyleWid ? selStyleWid.widgetTitle : 'Untitled' }} Properties</h3>
                      <span class="f-spacer"></span>
                      <button mat-icon-button (click)="showProperty=false">
                        <mat-icon>clear</mat-icon>
                    </button>
                    </mat-toolbar-row>
                </mat-toolbar>
                <mat-card-content>
                    <div class="f-col" [formGroup] = "styleCtrlGrp">
                        <mat-form-field>
                            <mat-label>Widget Name</mat-label>
                            <input matInput formControlName="widgetName">
                        </mat-form-field>

                        <div class="f-row">
                            <mat-form-field class="field-divider">
                                <mat-label>Width</mat-label>
                                <input type="number" max="pixcel" min="0" matInput formControlName="width">
                            </mat-form-field>
                            <span class="f-col-spacer-half"></span>
                            <mat-form-field class="field-divider">
                                <mat-label>Height</mat-label>
                                <input type="number" min="200" matInput formControlName="height">
                            </mat-form-field>
                        </div>

                        <mat-form-field>
                            <mat-label>Data Set</mat-label>
                            <mat-select formControlName="objectType">
                                <mat-option *ngFor="let object of dataSetOb | async" value="{{ object.objectid }}"> {{ object.objectdesc }} </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <ng-template [ngIf]="selStyleWid && (selStyleWid.widgetType === 'COUNT' || selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'FILTER')">
                            <mat-form-field>
                                <mat-label>Field</mat-label>
                                <mat-select formControlName="field">
                                    <mat-option *ngFor="let field of headerFields | async" value="{{ field.fieldId }}"> {{ field.fieldDescri }} </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-template>

                        <!-- FOR COUNT WIDGET-->
                        <ng-template [ngIf]="selStyleWid  && (selStyleWid.widgetType === 'COUNT' || selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART') ">
                            <mat-form-field>
                                <mat-label>Aggregration Operator</mat-label>
                                <mat-select formControlName="aggregrationOp">
                                    <mat-option value="GROUPBY">GROUPBY</mat-option>
                                    <mat-option value="COUNT">COUNT</mat-option>
                                    <mat-option value="MIN">MIN</mat-option>
                                    <mat-option value="MAX">MAX</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-template>

                        <!-- FOR FILTERs WIDGET-->
                        <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'FILTER' ">
                            <mat-form-field>
                                <mat-label>Filter Type</mat-label>
                                <mat-select formControlName="filterType">
                                    <mat-option value="DROPDOWN_VALS">Dropdown value</mat-option>
                                    <mat-option value="HORIZONTAL_VALS">Horizontal value</mat-option>
                                    <mat-option value="VERTICAL_VALS">Vertical value</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-checkbox color="primary" formControlName="isMultiSelect">Is Multiselect</mat-checkbox>
                        </ng-template>

                        <!-- FOR STACKED BAR CHART WIDGET-->
                        <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'STACKED_BAR_CHART'">
                            <mat-form-field>
                                <mat-label>Group Id</mat-label>
                                <mat-select formControlName="groupById">
                                    <mat-option *ngFor="let field of headerFields | async" value="{{ field.fieldId }}"> {{ field.fieldDescri }} </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-template>

                        <!-- FOR TABLE LIST CHOOSE COLUMNS WIDGET-->
                        <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'TABLE_LIST'">
                            <mat-form-field>
                                <mat-label>{{ chooseColumns ? chooseColumns.length : '0' }} Selected</mat-label>
                                <mat-select>
                                    <mat-option *ngFor="let field of headerFields | async" value="{{ field.fieldId }}" >
                                          <div (click)="optionClicked($event, field)">
                                            <mat-checkbox prosClickStopPropagation (change)="toggleSelection(field)" [checked]="isSelected(field)" color="primary">
                                              {{ field.fieldDescri }}
                                            </mat-checkbox>
                                          </div>
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </ng-template>

                        <!-- FOR IMAGE WIDGET-->
                        <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'IMAGE'">
                            <mat-form-field>
                                <mat-label>Image Link</mat-label>
                                <input matInput formControlName="imageUrl">
                            </mat-form-field>

                            <div class="f-row">
                               <button mat-icon-button matTooltip="Upload image" (click)="uploadFileChange()">
                                   <mat-icon color="primary">add_photo_alternate</mat-icon>
                                </button>
                                <input type="file" (change)="fileChange($event)" style="display: none;" multiple="false" id="uploadFileCtrl" accept="image/png, image/jpeg"/>
                                <span class="f-col-spacer-half"></span>
                                <mat-form-field class="upload-img-inp">
                                    <input matInput disabled readonly formControlName="imageName">
                                    <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="removeUploadedImage()">
                                        <mat-icon>close</mat-icon>
                                    </button>
                                </mat-form-field>
                            </div>
                        </ng-template>

                        <!-- FOR IMAGE WIDGET-->
                        <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'HTML'">
                            <mat-form-field>
                                <mat-label>Html Containt</mat-label>
                                <textarea matInput placeholder="Write html text.." formControlName="htmlText"></textarea>
                            </mat-form-field>
                        </ng-template>

                        

                        <!-- <mat-form-field>
                            <mat-label>Data Set</mat-label>
                            <input matInput>
                        </mat-form-field>

                        <mat-form-field>
                            <mat-label>x axis</mat-label>
                            <mat-select>
                                <mat-option>Select</mat-option>
                            </mat-select>
                        </mat-form-field>

                        <div class="f-row">
                            <mat-form-field class="field-divider">
                                <mat-label>y axis</mat-label>
                                <mat-select>
                                    <mat-option>Select</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <span class="f-col-spacer-half"></span>
                            <mat-form-field class="field-divider">
                                <mat-label>Aggregration Type</mat-label>
                                <mat-select>
                                    <mat-option>Select</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <mat-form-field>
                            <mat-label>Background Color</mat-label>
                            <mat-select>
                                <mat-option>Red</mat-option>
                                <mat-option>White</mat-option>
                                <mat-option>Black</mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field>
                            <mat-label>Chart Orientation</mat-label>
                            <mat-select>
                                <mat-option>Vertical</mat-option>
                                <mat-option>Horizontal</mat-option>
                            </mat-select>
                        </mat-form-field> -->
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </mat-card>
    
</div>






