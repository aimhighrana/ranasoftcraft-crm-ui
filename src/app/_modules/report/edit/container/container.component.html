<div class="root">
    <div class="f-row-spacer-half"></div>
    <div class="f-row">
        <lib-text-line type="leading">Dashboard builder</lib-text-line>
        <div class="f-spacer"></div>
        <lib-button-group>
            <lib-button type="minor" *ngIf="collaboratorPermission && reportId"
                [routerLink]="['', { outlets: { sb: 'sb/report/collaborators/' + reportId } } ]" iconPosition="before"
                icon="user-plus"> Add collaborators </lib-button>
            <lib-button (click)="createUpdateReport()" type="major">Save</lib-button>
        </lib-button-group>
    </div>

    <div class="row-spacer"></div>

    <div class="f-col report-builder">
        <pros-form-input [type]="'text'" [placeholder]="'Untitled-1'" [control]="reportName" [label]="'Dashboard name'"
            [value]="reportName.value" [maxLength]="maxReportNameLength">
        </pros-form-input>
        <div class="row-spacer"></div>
        <div class="f-row builder-container">
            <div class="widget-col">
                <div class="f-row-spacer-half"></div>
                <div class="f-col col-heading">
                    <lib-text-line class="headine" type="leading">Widgets</lib-text-line>
                    <div class="f-row-spacer-half"></div>
                    <lib-text-line type="base" [enableWrap]="true">Add a widget to your dashboard by clicking on one of
                        the options below</lib-text-line>
                </div>
                <lib-section></lib-section>
                <div class="container" cdkDropList cdkDropListConnectedTo="container">
                    <div widgetType="FILTER" class="widget-drag" (click)="addWidget($event, 'FILTER')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">filter</mat-icon> Filter
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="COUNT" class="widget-drag" (click)="addWidget($event, 'COUNT')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">hashtag</mat-icon> Metric
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="TABLE_LIST" class="widget-drag" (click)="addWidget($event, 'TABLE_LIST')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">table</mat-icon> Table list
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="BAR_CHART" class="widget-drag" (click)="addWidget($event, 'BAR_CHART')">
                        <mat-icon fontSet="mdo-icons-solid" class="widget-icon">chart-pie</mat-icon> Bar/pie chart
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="STACKED_BAR_CHART" class="widget-drag"
                        (click)="addWidget($event, 'STACKED_BAR_CHART')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">analytics</mat-icon> Stacked bar chart
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="IMAGE" class="widget-drag" (click)="addWidget($event, 'IMAGE')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">image</mat-icon> Image
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="HTML" class="widget-drag" (click)="addWidget($event, 'HTML')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">arrows-alt-h</mat-icon> HTML editor
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                    <div widgetType="TIMESERIES" class="widget-drag" (click)="addWidget($event, 'TIMESERIES')">
                        <mat-icon fontSet="mdo-icons" class="widget-icon">clock</mat-icon> Time series
                        <div class="f-spacer"></div>
                        <lib-button type="plain" icon="plus"></lib-button>
                    </div>
                    <lib-section></lib-section>
                </div>
            </div>

            <mat-card class="mat-elevation-z0 container-show builder-board" [ngStyle]="containerCss"
                [class.adjust-property]="showProperty" id="container" cdkDragBoundary cdkDropList
                (cdkDropListDropped)="drop($event)">
                <ng-template ngFor let-widget [ngForOf]="widgetList">
                    <pros-dynamic-widget [widget]="widget" [boxSize]="eachBoxSize" (evtDelete)="delete($event)"
                        (evtStyle)="showStyle($event)">
                    </pros-dynamic-widget>
                </ng-template>
            </mat-card>


            <div cdkScrollable class="property-col" *ngIf="showProperty">
                <div class="f-row-spacer-half"></div>
                <div class="f-row col-heading">
                    <lib-text-line type="leading">{{ selStyleWid ? selStyleWid.widgetTitle : 'Untitled' }} properties
                    </lib-text-line>
                    <div class="f-spacer"></div>
                    <lib-button (click)="showProperty=false" type="plain" icon="times"></lib-button>
                </div>

                <!-- BASIC CONFIGURATION-->
                <div class="collapsible">
                    <mat-accordion>
                        <mat-expansion-panel class="mat-elevation-z0" togglePosition="before" expanded="true">
                            <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px">
                                <mat-panel-title class="panel-title">
                                    Basic configuration
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="f-col fields-col" [formGroup]="styleCtrlGrp">
                                <div class="f-col">

                                    <lib-input label="Widget name" formControlName="widgetName"></lib-input>
                                </div>

                                <div class="f-row">
                                    <div class="f-col">

                                        <lib-input type="number" label="Width" [max]="widgetMaxWidth" min="1"
                                            formControlName="width" (input)="widthCount($event.target.value)">
                                        </lib-input>

                                    </div>
                                    <span class="col-spacer"></span>
                                    <div class="f-col">

                                        <lib-input type="number" label="Height" min="0" [max]="widgetMaxHeight"
                                            formControlName="height" (input)="heightCount($event.target.value)">
                                        </lib-input>
                                    </div>
                                </div>

                                <div class="f-col">
                                    <ng-template
                                        [ngIf]="selStyleWid && !(selStyleWid.widgetType === 'IMAGE' || selStyleWid.widgetType === 'HTML')">
                                        <ng-template
                                            [ngIf]="styleCtrlGrp.get('isWorkflowdataSet') && styleCtrlGrp.get('isWorkflowdataSet').value "
                                            [ngIfElse]="singleSelect">
                                            <mat-label>Data set ({{
                                                styleCtrlGrp.get('objectType').value.split(',').length
                                                }} selected) </mat-label>
                                        </ng-template>
                                        <ng-template #singleSelect>
                                            <mat-label>Data set</mat-label>
                                        </ng-template>


                                        <div class="f-col mdo-field">
                                            <!-- label -->
                                            <!-- input container -->
                                            <div class="mdo-field-input">
                                                <input matInput #datasetTrigger="matAutocompleteTrigger"
                                                    [formControl]="datasetCtrl" [matAutocomplete]="datasetList"
                                                    (click)="openAutoComplete(datasetTrigger)"
                                                    (keyup)="openAutoComplete(datasetTrigger); searchDataSet($event.target.value)">
                                                <mat-autocomplete #datasetList="matAutocomplete"
                                                    [displayWith]="displayWithDataSet">
                                                    <mat-optgroup label="Module">
                                                        <mat-option class="mdo-option"
                                                            *ngFor="let object of dataSetOb | async" [value]="object"
                                                            (click)="afterDataSetSelect(object)">
                                                            {{ object.objectdesc ? object.objectdesc : 'Untitled' }}
                                                        </mat-option>
                                                    </mat-optgroup>

                                                    <mat-optgroup label="Custom">
                                                        <mat-option class="mdo-option"
                                                            *ngFor="let object of customDataSetob | async"
                                                            [value]="object" (click)="afterCustomSelect(object)">
                                                            {{ object.objectdesc ? object.objectdesc : 'Untitled' }}
                                                        </mat-option>
                                                    </mat-optgroup>

                                                    <pros-workflow-dataset (selectedWfs)="afterWfSelect($event)"
                                                        [preSelectedObj]="selStyleWid ? selStyleWid.objectType : ''"
                                                        [isWorkFlow]="isWorkflowRefresh"
                                                        [searchText]="searchDataSetVal">
                                                    </pros-workflow-dataset>
                                                </mat-autocomplete>
                                            </div>
                                            <!-- hint -->
                                            <mat-hint class="mdo-field-hint"
                                                *ngIf="selStyleWid  && selStyleWid.objectType && recordsCount">Total
                                                {{ recordsCount }} record(s) found</mat-hint>
                                            <mat-hint class="mdo-field-hint"
                                                *ngIf="selStyleWid  && selStyleWid.objectType && !recordsCount">Index
                                                not
                                                found , please sync data</mat-hint>
                                        </div>
                                    </ng-template>
                                </div>

                                <div class="f-col mdo-field">
                                    <!-- <For WorkFlow Path> -->
                                    <ng-template
                                        [ngIf]="styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true  && styleCtrlGrp.get('isCustomdataSet').value===false">
                                        <mat-label i18n="@@workFlowPath">Workflow path</mat-label>
                                        <div class="mdo-field-input" >
                                            <input matInput placeholder="Type to search" #optionInput
                                                formControlName="workflowPath" [matAutocomplete]="auto" disabled
                                                [value]="displayWithWorkflowDesc()" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                               (optionSelected)="selectedWorkFlow($event.option.value)">
                                                <mat-option *ngFor="let workflow of workflowPathOb | async"
                                                    [value]="workflow" class="mdo-option">
                                                    <lib-checkbox
                                                        [label]="workflow.workflowdesc ? workflow.workflowdesc : 'Unknown path'"
                                                        [checked]="isCheckedWorkflow(workflow)" 
                                                        (valueChange)="selectedWorkFlow(workflow)"
                                                        prosClickStopPropagation>
                                                    </lib-checkbox>
                                                </mat-option>
                                            </mat-autocomplete>
                                        </div>
                                    </ng-template>
                                </div>



                                <div class="f-col">
                                    <!--Modules-->
                                    <ng-template
                                        [ngIf]="selStyleWid && (selStyleWid.widgetType === 'COUNT' || selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'FILTER'  || selStyleWid.widgetType === 'TIMESERIES') && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false">
                                        <pros-metadatafield-control [moduleId]="selStyleWid && selStyleWid.objectType"
                                            lebel="Field" [selectedFldId]="selStyleWid && selStyleWid.field"
                                            [isCustomdataset]="selStyleWid && selStyleWid.isCustomdataSet"
                                            (selectionChange)='onFieldChange($event)'>
                                        </pros-metadatafield-control>
                                    </ng-template>

                                    <!--WorkflowType-->
                                    <ng-template
                                        [ngIf]="selStyleWid && (selStyleWid.widgetType === 'COUNT' || selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'FILTER' || selStyleWid.widgetType === 'TIMESERIES') && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true && styleCtrlGrp.get('isCustomdataSet').value===false">
                                        <pros-workflowfield-control [controlFor]="'Field'"
                                            [widgetType]="selStyleWid && selStyleWid.widgetType"
                                            [objectType]="selStyleWid && selStyleWid.objectType" label="Field"
                                            [selectedFldId]="selStyleWid && selStyleWid.field"
                                            (selectionChange)='onFieldChange($event)'>
                                        </pros-workflowfield-control>
                                    </ng-template>
                                </div>
                                <div class="f-col mdo-field">
                                    <!-- FOR Aggregration -->
                                    <ng-template
                                        [ngIf]="selStyleWid && (selStyleWid.widgetType === 'COUNT' || selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'TIMESERIES') ">
                                        <mat-label i18n="@@aggregrationOperator">Aggregration operator</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput placeholder="Type to search" #optionsInput
                                                formControlName="aggregrationOp" [matAutocomplete]="auto1" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto1="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <ng-container
                                                    *ngFor="let aggOp of getValue(aggregrationOp,styleCtrlGrp.get('aggregrationOp'))">
                                                    <mat-option [value]="aggOp"
                                                        *ngIf="aggOp.key === 'GROUPBY' && (selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'TIMESERIES')">
                                                        {{aggOp.value}}</mat-option>
                                                    <mat-option [value]="aggOp"
                                                        *ngIf="(aggOp.key === 'COUNT' && (selStyleWid.widgetType === 'COUNT'))">
                                                        {{aggOp.value}}</mat-option>
                                                    <mat-option [value]="aggOp"
                                                        *ngIf="(aggOp.key === 'SUM' && (selStyleWid.widgetType === 'COUNT' && checkFieldDataType))">
                                                        {{aggOp.value}}</mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </div>
                                    </ng-template>
                                </div>
                                <div class="f-col">
                                    <!-- FOR  Modules STACKED BAR CHART WIDGET-->
                                    <ng-template
                                        [ngIf]="selStyleWid && (selStyleWid.widgetType === 'STACKED_BAR_CHART'  || selStyleWid.widgetType === 'TIMESERIES') && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false">
                                        <pros-metadatafield-control [moduleId]="selStyleWid && selStyleWid.objectType"
                                            [widgetType]="selStyleWid && selStyleWid.widgetType" lebel="Group(s) with"
                                            [selectedFldId]="selStyleWid && selStyleWid.groupById"
                                            [isCustomdataset]="selStyleWid && selStyleWid.isCustomdataSet"
                                            (selectionChange)='onGroupByChange($event)'>
                                        </pros-metadatafield-control>
                                    </ng-template>

                                    <!-- FOR Workflow STACKED BAR CHART WIDGET-->
                                    <ng-template
                                        [ngIf]="selStyleWid && (selStyleWid.widgetType === 'STACKED_BAR_CHART'|| selStyleWid.widgetType === 'TIMESERIES') && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true && styleCtrlGrp.get('isCustomdataSet').value===false">
                                        <pros-workflowfield-control [objectType]="selStyleWid && selStyleWid.objectType"
                                            [widgetType]="selStyleWid && selStyleWid.widgetType" label="Group with(s)"
                                            [controlFor]="'GroupWith'"
                                            [selectedFldId]="selStyleWid && selStyleWid.groupById"
                                            (selectionChange)='onGroupByChange($event)'>
                                        </pros-workflowfield-control>
                                    </ng-template>
                                </div>

                                <div class="f-col">
                                    <!--TransitionalType-->
                                    <ng-template
                                        [ngIf]="selStyleWid && selStyleWid.widgetType === 'TIMESERIES' && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false && selStyleWid.groupById">
                                        <pros-metadatafield-control [moduleId]="selStyleWid && selStyleWid.objectType"
                                            lebel="Distinct with"
                                            [selectedFldId]="selStyleWid && selStyleWid.distictWith"
                                            (selectionChange)='onDistictWithChange($event)'
                                            [isCustomdataset]="selStyleWid && selStyleWid.isCustomdataSet">
                                        </pros-metadatafield-control>
                                    </ng-template>

                                    <!--WorkflowType-->
                                    <ng-template
                                        [ngIf]="selStyleWid && selStyleWid.widgetType === 'TIMESERIES' && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true  && styleCtrlGrp.get('isCustomdataSet').value===false && selStyleWid.groupById">
                                        <pros-workflowfield-control [objectType]="selStyleWid && selStyleWid.objectType"
                                            label="Distinct with"
                                            [selectedFldId]="selStyleWid && selStyleWid.distictWith"
                                            (selectionChange)='onDistictWithChange($event)'>
                                        </pros-workflowfield-control>
                                    </ng-template>
                                </div>

                                <div class="f-col" *ngIf="selStyleWid && selStyleWid.widgetType === 'COUNT'">
                                    <lib-checkbox label="Include field as distinct" formControlName="isFieldDistinct">
                                    </lib-checkbox>
                                </div>

                                <div class="f-col">
                                    <!-- FOR FILTERs WIDGET-->
                                    <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'FILTER' ">
                                        <!-- if date type field then , special config -->
                                        <ng-template
                                            [ngIf]="selStyleWid.fieldCtrl && ((selStyleWid.fieldCtrl.picklist === '0' && (selStyleWid.fieldCtrl.dataType === 'DTMS' || selStyleWid.fieldCtrl.dataType === 'DATS')) || selStyleWid.fieldCtrl.fieldId === 'REQUESTOR_DATE' 
                                            || selStyleWid.fieldCtrl.fieldId === 'DUE_DATE' || selStyleWid.fieldCtrl.fieldId === 'DATE_STARTED' || selStyleWid.fieldCtrl.fieldId === 'FINISHDATE')"
                                            [ngIfElse]="otherCtrl">

                                            <div class="f-col mdo-field">
                                                <mat-label i18n="@@selectDefaultDays">Select default days</mat-label>
                                                <div class="mdo-field-input">
                                                    <input matInput placeholder="Type to search" #optionsInput
                                                        formControlName="dateSelectionType" [matAutocomplete]="auto1" />
                                                    <mat-autocomplete class="mdo-autocomplete" #auto1="matAutocomplete"
                                                        [displayWith]="displayProperties">
                                                        <mat-option i18n="@@noDate">No date</mat-option>
                                                        <mat-option
                                                            *ngFor="let opt of getValue(dateSelectionType,styleCtrlGrp.get('dateSelectionType'))"
                                                            [value]="opt">
                                                            {{opt.value}}
                                                        </mat-option>
                                                    </mat-autocomplete>
                                                </div>
                                            </div>



                                            <!-- when user choose custom date then start and end date should appear -->


                                            <lib-date-range-picker label="Start date"
                                                *ngIf="styleCtrlGrp && styleCtrlGrp.get('dateSelectionType').value === 'CUSTOM'"
                                                formControlName="startDate">
                                            </lib-date-range-picker>

                                        </ng-template>
                                        <ng-template #otherCtrl>
                                            <div class="f-col mdo-field">
                                                <mat-label i18n="@@filterType">Filter type</mat-label>
                                                <div class="mdo-field-input">
                                                    <input matInput placeholder="Type to search" #optionsInput
                                                        formControlName="filterType" [matAutocomplete]="auto1" />
                                                    <mat-autocomplete class="mdo-autocomplete" #auto1="matAutocomplete"
                                                        [displayWith]="displayProperties">
                                                        <mat-option
                                                            *ngFor="let opt of getValue(filterType,styleCtrlGrp.get('filterType'))"
                                                            [value]="opt">
                                                            {{opt.value}}
                                                        </mat-option>
                                                    </mat-autocomplete>
                                                </div>
                                            </div>

                                            <div class="f-col">
                                                <lib-checkbox formControlName="isMultiSelect" label="Is multiselect">
                                                </lib-checkbox>

                                            </div>
                                            <div class="f-col mdo-field">
                                                <mat-label i18n="@@sortBy">Sort by</mat-label>
                                                <div class="mdo-field-input">
                                                    <input matInput placeholder="Type to search" #optInput
                                                        formControlName="orderWith" [matAutocomplete]="auto" />
                                                    <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                                        [displayWith]="displayProperties">
                                                        <ng-container
                                                            *ngFor="let sort of getValue(orderWith,styleCtrlGrp.get('orderWith'))">
                                                            <mat-option
                                                                *ngIf="sort.key === OrderWith.ASC || sort.key === OrderWith.DESC"
                                                                [value]="sort">
                                                                {{sort.value}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </div>
                                            </div>
                                        </ng-template>
                                    </ng-template>
                                </div>

                                <div class="f-col">
                                    <!-- FOR TABLE LIST CHOOSE COLUMNS WIDGET-->
                                    <!-- For Modules -->
                                    <ng-template
                                        [ngIf]="selStyleWid && selStyleWid.widgetType === 'TABLE_LIST' && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false  && styleCtrlGrp.get('isCustomdataSet').value===false">


                                        <div class="f-col mdo-field">
                                            <!-- label -->
                                            <mat-label class="mdo-field-label">Choose columns</mat-label>
                                            <!-- input container -->
                                            <div class="mdo-field-input">
                                                <input matInput [matAutocomplete]="chooseColumnM"
                                                    [formControl]="fieldCtrl" #columnsTriggerM="matAutocompleteTrigger"
                                                    (click)="openAutoComplete(columnsTriggerM)"
                                                    (keyup)="openAutoComplete(columnsTriggerM);searchChooseColumn($event.target.value)">
                                                <!-- autocomplete -->
                                                <mat-autocomplete #chooseColumnM="matAutocomplete"
                                                    [displayWith]="chooseColumnDisWith"
                                                    (opened)="removeError('fieldCtrl')">
                                                    <mat-optgroup label="System fileds">
                                                        <mat-option *ngFor="let field of systemFields
                                                        " value="{{ field.fieldId }}">
                                                            <div (click)="optionClicked($event, field)">
                                                                <lib-checkbox prosClickStopPropagation
                                                                    (valueChange)="toggleSelection(field)"
                                                                    [checked]="isSelected(field)"
                                                                    [label]="field.fieldDescri">
                                                                </lib-checkbox>
                                                            </div>
                                                        </mat-option>
                                                    </mat-optgroup>
                                                    <mat-optgroup label="Header fileds">
                                                        <mat-option *ngFor="let field of headerFields | async"
                                                            value="{{ field.fieldId }}">
                                                            <div (click)="optionClicked($event, field)">
                                                                <lib-checkbox prosClickStopPropagation
                                                                    (valueChange)="toggleSelection(field)"
                                                                    [checked]="isSelected(field)"
                                                                    [label]="field.fieldDescri">
                                                                </lib-checkbox>
                                                            </div>
                                                        </mat-option>
                                                    </mat-optgroup>
                                                    <mat-optgroup [label]="fld.fieldDescri"
                                                        *ngFor="let fld of fieldsObs|async">
                                                        <mat-option *ngFor="let field of fld.childs"
                                                            value="{{ field.fieldId }}">
                                                            <div (click)="optionClicked($event, field)">
                                                                <lib-checkbox prosClickStopPropagation
                                                                    (valueChange)="toggleSelection(field)"
                                                                    [checked]="isSelected(field)"
                                                                    [label]="field.fieldDescri">
                                                                </lib-checkbox>
                                                            </div>
                                                        </mat-option>
                                                    </mat-optgroup>
                                                </mat-autocomplete>
                                            </div>
                                            <!-- hint -->
                                            <mat-hint class="mdo-field-hint">{{ chooseColumns ? chooseColumns.length :
                                                '0' }} Selected</mat-hint>
                                        </div>

                                    </ng-template>

                                    <!-- For WorkFlow Modules -->
                                    <ng-template
                                        [ngIf]="selStyleWid && selStyleWid.widgetType === 'TABLE_LIST' && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true  && styleCtrlGrp.get('isCustomdataSet').value===false">

                                        <div class="f-col mdo-field">
                                            <!-- label -->
                                            <mat-label class="mdo-field-label">Choose columns</mat-label>
                                            <!-- input container -->
                                            <div class="mdo-field-input">
                                                <input matInput [matAutocomplete]="chooseColumnWF"
                                                    [formControl]="fieldCtrl" #columnsTriggerWM="matAutocompleteTrigger"
                                                    (click)="openAutoComplete(columnsTriggerWM)"
                                                    (keyup)="openAutoComplete(columnsTriggerWM); searchChooseColumnWorkflow($event.target.value)">
                                                <!-- autocomplete -->
                                                <mat-autocomplete #chooseColumnWF="matAutocomplete"
                                                    (opened)="removeError('fieldCtrl')"
                                                    [displayWith]="chooseColumnDisWith">
                                                    <mat-optgroup label="System fileds">
                                                        <mat-option
                                                            *ngFor="let field of (workflowFieldsObs | async).static"
                                                            value="{{ field.fieldId }}">
                                                            <div (click)="optionClicked($event, field)">
                                                                <lib-checkbox prosClickStopPropagation
                                                                    (valueChange)="toggleSelection(field)"
                                                                    [checked]="isSelected(field)"
                                                                    [label]="field.fieldDescri">
                                                                </lib-checkbox>
                                                            </div>
                                                        </mat-option>
                                                    </mat-optgroup>

                                                    <mat-optgroup label="Module fileds">
                                                        <mat-option
                                                            *ngFor="let field of (workflowFieldsObs | async).dynamic"
                                                            value="{{ field.fieldId }}">
                                                            <div (click)="optionClicked($event, field)">
                                                                <lib-checkbox prosClickStopPropagation
                                                                    (valueChange)="toggleSelection(field)"
                                                                    [checked]="isSelected(field)"
                                                                    [label]="field.fieldDescri">
                                                                </lib-checkbox>
                                                            </div>
                                                        </mat-option>
                                                    </mat-optgroup>
                                                </mat-autocomplete>
                                            </div>
                                            <!-- hint -->
                                            <mat-hint class="mdo-field-hint">{{ chooseColumns ? chooseColumns.length :
                                                '0' }} Selected</mat-hint>
                                        </div>

                                    </ng-template>

                                    <!-- For Custom Modules -->
                                    <ng-template
                                        [ngIf]="selStyleWid && selStyleWid.widgetType === 'TABLE_LIST' && styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false && styleCtrlGrp.get('isCustomdataSet').value===true">

                                        <div class="f-col mdo-field">
                                            <!-- label -->
                                            <mat-label class="mdo-field-label">Choose columns</mat-label>
                                            <!-- input container -->
                                            <div class="mdo-field-input">
                                                <input matInput [matAutocomplete]="chooseColumnCM"
                                                    [formControl]="fieldCtrl" #columnsTriggerCM="matAutocompleteTrigger"
                                                    (click)="openAutoComplete(columnsTriggerCM)"
                                                    (keyup)="openAutoComplete(columnsTriggerCM); searchCustomChooseColumn($event.target.value)">
                                                <!-- autocomplete -->
                                                <mat-autocomplete #chooseColumnCM="matAutocomplete"
                                                    (opened)="removeError('fieldCtrl')"
                                                    [displayWith]="chooseColumnDisWith">
                                                    <mat-option *ngFor="let fld of CustomfieldsObs | async"
                                                        value="{{ fld.fieldId }}">
                                                        <div (click)="optionClicked($event, fld)">
                                                            <lib-checkbox prosClickStopPropagation
                                                                (valueChange)="toggleSelection(fld)"
                                                                [checked]="isSelected(fld)" [label]="fld.fieldDescri">
                                                            </lib-checkbox>
                                                        </div>
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </div>
                                            <!-- hint -->
                                            <mat-hint class="mdo-field-hint">{{ chooseColumns ? chooseColumns.length :
                                                '0' }} Selected</mat-hint>
                                        </div>

                                    </ng-template>
                                </div>
                                <div class="f-col mdo-field">
                                    <!-- FOR TABLE LIST CHOOSE Default Page Size and Column format-->
                                    <!-- For Modules -->
                                    <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'TABLE_LIST' ">
                                        <lib-input type="number" label="Default page Size"
                                            (input)="checkNumLength($event.target.value)"
                                            formControlName="pageDefaultSize" placeholder="Default page size">
                                        </lib-input>

                                        <mat-label i18n="@@columnFormat">Column format</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput placeholder="Type to search" #optionsInput
                                                formControlName="displayCriteria" [matAutocomplete]="auto1" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto1="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <mat-option
                                                    *ngFor="let col of getValue(displayCriteria,styleCtrlGrp.get('displayCriteria'))"
                                                    [value]="col">
                                                    {{col.value}}
                                                </mat-option>
                                            </mat-autocomplete>
                                        </div>
                                    </ng-template>
                                </div>

                                <div class="f-col">
                                    <lib-checkbox formControlName="isEnableGlobalFilter" label="Global Filters
                                    not applicable"></lib-checkbox>
                                </div>


                                <div class="row-spacer"></div>
                                <div class="f-col">
                                    <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType !== 'TABLE_LIST'">
                                        <lib-checkbox formControlName="applyDistinct" label="Apply distinct">
                                        </lib-checkbox>
                                    </ng-template>
                                </div>

                                <div class="f-col">
                                    <!-- FOR IMAGE WIDGET-->
                                    <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'IMAGE'">

                                        <lib-input label="Image link" formControlName="imageUrl"></lib-input>

                                        <div class="f-row image-algin">
                                            <lib-button (click)="uploadFileChange()" prosClickStopPropagation
                                                icon="image">
                                            </lib-button>
                                            <input type="file" (change)="fileChange($event)" style="display: none;"
                                                id="uploadFileCtrl" accept="image/png, image/jpeg"
                                                prosClickStopPropagation />
                                            <span class="col-spacer"></span>

                                            <lib-input disabled readonly formControlName="imageName">
                                            </lib-input>
                                            <mat-divider [vertical]="true"></mat-divider>
                                            <lib-button type="plain" icon="times" matSuffix
                                                (click)="removeUploadedImage()">
                                            </lib-button>

                                        </div>
                                    </ng-template>
                                </div>

                                <div class="f-col">
                                    <!-- FOR IMAGE WIDGET-->
                                    <ng-template [ngIf]="selStyleWid && selStyleWid.widgetType === 'HTML'">

                                        <lib-textarea label="HTML content" placeholder="Write html text.."
                                            formControlName="htmlText" [rows]="2"></lib-textarea>

                                    </ng-template>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </div>


                <!-- CHART PROPERTIES -->
                <div class="collapsible">
                    <mat-accordion
                        *ngIf="selStyleWid  && (selStyleWid.widgetType === 'BAR_CHART' || selStyleWid.widgetType === 'STACKED_BAR_CHART' || selStyleWid.widgetType === 'TIMESERIES') ">
                        <mat-expansion-panel class="mat-elevation-z0" togglePosition="before" expanded="true">
                            <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px">
                                <mat-panel-title class="panel-title" i18n="@@chartProperties">
                                    Chart properties
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="f-col fields-col" [formGroup]="chartPropCtrlGrp">
                                <div class="f-col mdo-field">
                                    <mat-label i18n="@@chartType">Chart type </mat-label>
                                    <div class="mdo-field-input"
                                        [disabled]="selStyleWid.widgetType === 'STACKED_BAR_CHART'">
                                        <input matInput placeholder="Type to search" #optionsInput
                                            formControlName="chartType" [matAutocomplete]="auto" />
                                        <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                            [displayWith]="displayProperties">
                                            <ng-container
                                                *ngFor="let chart of getValue(chartType,chartPropCtrlGrp.get('chartType'))">
                                                <mat-option
                                                    *ngIf="selStyleWid.widgetType === 'BAR_CHART' && chart.key === 'PIE'"
                                                    [value]="chart">
                                                    {{chart.value}}
                                                </mat-option>
                                                <mat-option
                                                    *ngIf="selStyleWid.widgetType === 'TIMESERIES' && chart.key === 'LINE'"
                                                    [value]="chart">
                                                    {{chart.value}}
                                                </mat-option>
                                                <mat-option [value]="chart" *ngIf="chart.key === 'BAR'">
                                                    {{chart.value}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </div>
                                </div>
                                <div class="f-col mdo-field" *ngIf="selStyleWid.widgetType !== 'TIMESERIES'">
                                    <mat-label i18n="@@orientation">Orientation</mat-label>
                                    <div class="mdo-field-input"
                                        *ngIf="chartPropCtrlGrp && chartPropCtrlGrp.get('chartType').value?.key === 'BAR'">
                                        <input matInput #optionsInput formControlName="orientation"
                                            [matAutocomplete]="auto" />
                                        <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                            [displayWith]="displayProperties">
                                            <mat-option
                                                *ngFor="let orint of getValue(orientation,chartPropCtrlGrp.get('orientation'))"
                                                [value]="orint">
                                                {{ orint.value}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </div>
                                </div>

                                <ng-template
                                    [ngIf]="chartPropCtrlGrp && chartPropCtrlGrp.get('chartType').value?.key === 'BAR' || chartPropCtrlGrp.get('chartType').value?.key === 'LINE'">
                                    <div class="f-col">


                                        <lib-input label="X-axis label" formControlName="xAxisLabel"
                                            [maxLength]="maxReportNameLength"></lib-input>
                                    </div>

                                    <div class="f-col">

                                        <lib-input label="Y-axis label" formControlName="yAxisLabel"
                                            [maxLength]="maxReportNameLength"></lib-input>
                                    </div>

                                    <div class="f-col  mdo-field" *ngIf="selStyleWid.widgetType !== 'TIMESERIES'">
                                        <mat-label i18n="@@sortBy">Sort by</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput #optInput formControlName="orderWith"
                                                [matAutocomplete]="auto" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <ng-container
                                                    *ngFor="let sort of getValue(orderWith,chartPropCtrlGrp.get('orderWith'))">
                                                    <mat-option
                                                        *ngIf="sort.key !== OrderWith.ASC && sort.key !== OrderWith.DESC"
                                                        [value]="sort">
                                                        {{sort.value}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </div>
                                    </div>
                                    <ng-template
                                        [ngIf]="(selStyleWid && selStyleWid.widgetType !== 'TIMESERIES') || chartPropCtrlGrp.get('chartType').value?.key === 'LINE'">
                                        <div class="f-col">
                                            <div class="f-row">
                                                <div class="f-col">

                                                    <lib-input label="Scale from" type="number" min="0"
                                                        formControlName="scaleFrom"></lib-input>
                                                </div>
                                                <span class="col-spacer"></span>
                                                <div class="f-col">

                                                    <lib-input label="Scale to" type="number" min="0"
                                                        formControlName="scaleTo"></lib-input>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="f-col">
                                            <div class="f-row">
                                                <div class="f-col">

                                                    <lib-input label="Scale step size" type="number" min="0"
                                                        formControlName="stepSize"></lib-input>
                                                </div>
                                                <span class="col-spacer"></span>
                                                <div class="f-col">

                                                    <lib-input label="Max dataset number" type="number" min="0"
                                                        formControlName="dataSetSize"></lib-input>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>

                                <div class="f-col">

                                    <lib-checkbox formControlName="isEnableDatalabels" label="Enable datalabels">
                                    </lib-checkbox>
                                </div>
                                <div class="f-row-spacer-half"></div>
                                <div class="f-col mdo-field"
                                    *ngIf="chartPropCtrlGrp && chartPropCtrlGrp.get('isEnableDatalabels').value && chartPropCtrlGrp.get('chartType').value?.key !== 'PIE'">
                                    <mat-label i18n="@@datalabelsPosition">Datalabels position</mat-label>
                                    <div class="mdo-field-input">
                                        <input matInput placeholder="Type to search" #optionsInput
                                            formControlName="datalabelsPosition" [matAutocomplete]="auto" />
                                        <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                            [displayWith]="displayProperties">
                                            <mat-option
                                                *ngFor="let data of getValue(datalabelsPosition,chartPropCtrlGrp.get('datalabelsPosition'))"
                                                [value]="data">
                                                {{ data.value}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </div>
                                </div>

                                <!-- PIE CHART PERCETAGE CONFIG -->
                                <div class="f-col"
                                    *ngIf="chartPropCtrlGrp && chartPropCtrlGrp.get('isEnableDatalabels').value && ( chartPropCtrlGrp.get('chartType').value?.key === 'PIE' || (selStyleWid && selStyleWid.widgetType === 'TIMESERIES' &&  selStyleWid.field === 'TIME_TAKEN') )">

                                    <lib-checkbox label="Show data in %" formControlName="isEnabledBarPerc">
                                    </lib-checkbox>
                                </div>
                                <!-- PIE CHART PERCETAGE CONFIG -->

                                <div class="f-col">

                                    <lib-checkbox label="Show legend" formControlName="isEnableLegend">
                                    </lib-checkbox>
                                </div>
                                <div class="f-row-spacer-half"></div>
                                <div class="f-col mdo-field"
                                    *ngIf="chartPropCtrlGrp && chartPropCtrlGrp.get('isEnableLegend').value">
                                    <mat-label i18n="@@legendPosition">Legend position</mat-label>
                                    <div class="mdo-field-input">
                                        <input matInput placeholder="Type to search" #optionsInput
                                            formControlName="legendPosition" [matAutocomplete]="auto1" />
                                        <mat-autocomplete class="mdo-autocomplete" #auto1="matAutocomplete"
                                            [displayWith]="displayProperties">
                                            <mat-option
                                                *ngFor="let legend of getValue(legendPosition,chartPropCtrlGrp.get('legendPosition'))"
                                                [value]="legend">
                                                {{ legend.value}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </div>
                                </div>
                                <div class="f-col" *ngIf="selStyleWid.widgetType !== 'TIMESERIES'">
                                    <lib-input label="Default value alias" formControlName="blankValueAlias">
                                    </lib-input>
                                </div>

                                <div class="f-col"
                                    *ngIf="selStyleWid.widgetType === 'TIMESERIES' && !selStyleWid.chartProperties?.hasCustomSLA">
                                    <!-- SERIES WITH -->
                                    <div class="f-col mdo-field">
                                        <mat-label class="mdo-field-label" i18n="@@serieswith">Series with</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput #optionsInput formControlName="seriesWith"
                                                [matAutocomplete]="auto" />
                                            <!-- autocomplete -->
                                            <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <ng-container
                                                    *ngFor="let opt of getValue(seriesWith,chartPropCtrlGrp.get('seriesWith'))">
                                                    <mat-option
                                                        *ngIf="(opt.key === 'year') || (opt.key !== 'year' && isSriesWithVisibile)"
                                                        [value]="opt" class="mdo-option">
                                                        {{opt.value}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </div>
                                    </div>
                                </div>

                                <div class="f-col" *ngIf="selStyleWid.widgetType === 'TIMESERIES'">
                                    <!-- SERIES FORMAT -->
                                    <div class="f-col mdo-field">
                                        <mat-label i18n="@@seriesFormat">Series format</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput placeholder="Type to search" #optionsInput
                                                formControlName="seriesFormat" [matAutocomplete]="auto" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete">
                                                <mat-option [value]="series"
                                                    *ngFor="let series of getSeriesValue(seriesFormat,chartPropCtrlGrp.get('seriesFormat'))">
                                                    {{series}} </mat-option>
                                            </mat-autocomplete>
                                        </div>
                                    </div>
                                </div>

                                <div class="f-col" *ngIf="selStyleWid.widgetType === 'TIMESERIES'">
                                    <!-- DATE RANGE FOR TIME SERIES -->
                                    <div class="f-col mdo-field">
                                        <mat-label i18n="@@selectInterval">Select interval</mat-label>
                                        <div class="mdo-field-input">
                                            <input matInput placeholder="Type to search" #optionsInput
                                                formControlName="timeseriesStartDate" [matAutocomplete]="auto" />
                                            <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <mat-option [value]="interval"
                                                    *ngFor="let interval of getValue(timeInterval,chartPropCtrlGrp.get('timeseriesStartDate'))">
                                                    {{interval.value}} </mat-option>
                                            </mat-autocomplete>
                                        </div>
                                    </div>
                                </div>

                                <div class="f-col mdo-field"
                                    *ngIf="selStyleWid && selStyleWid.widgetType === 'TIMESERIES' &&  selStyleWid.field === 'TIME_TAKEN'">
                                    <mat-label class="mdo-field-label" i18n="@@SLAFilter">SLA filter</mat-label>
                                    <div class="mdo-field-input">
                                        <input matInput placeholder="Type to search" #optionsInput
                                            formControlName="bucketFilter" [matAutocomplete]="auto" />
                                        <mat-autocomplete class="mdo-autocomplete" #auto="matAutocomplete"
                                            [displayWith]="displayProperties">
                                            <mat-option class="mdo-option"
                                                *ngFor="let bucket of getValue(bucketFilter,chartPropCtrlGrp.get('bucketFilter'))"
                                                [value]="bucket">
                                                {{ bucket.value }}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </div>
                                </div>

                                <div class="f-col"
                                    *ngIf="selStyleWid && selStyleWid.widgetType === 'TIMESERIES' &&  selStyleWid.field === 'TIME_TAKEN'  && !selStyleWid.chartProperties?.hasCustomSLA">
                                    <lib-input i18n="@@defaultSLA" label="Default SLA" placeholder="24 hours"
                                        [disabled]="true">
                                    </lib-input>
                                </div>

                                <div class="f-col"
                                    *ngIf="selStyleWid && selStyleWid.widgetType === 'TIMESERIES' &&  selStyleWid.field === 'TIME_TAKEN'">
                                    <lib-slide-toggle theme="primary" labelPosition="before"
                                        formControlName="hasCustomSLA" i18n="@@useCustomSLAValue"
                                        label="Use custom SLA value"></lib-slide-toggle>
                                </div>
                                <div class="f-row" *ngIf="selStyleWid && selStyleWid.chartProperties?.hasCustomSLA">
                                    <div class="f-col">
                                        <lib-input formControlName="slaValue" placeholder="8" type="number"></lib-input>
                                    </div>
                                    <span class="col-spacer"></span>
                                    <div class="f-col mdo-field">
                                        <div class="mdo-field-input">
                                            <input matInput placeholder="Type to search" #optionsInput
                                                formControlName="slaType" [matAutocomplete]="autoSLA" />
                                            <mat-autocomplete class="mdo-autocomplete" #autoSLA="matAutocomplete"
                                                [displayWith]="displayProperties">
                                                <mat-option class="mdo-option"
                                                    *ngFor="let type of getValue(slaMenu,chartPropCtrlGrp.get('slaType'))"
                                                    [value]="type">
                                                    {{ type.value }}
                                                </mat-option>
                                            </mat-autocomplete>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-spacer"></div>
                                <div class="f-col"
                                    *ngIf="(selStyleWid.chartProperties && (selStyleWid.chartProperties.chartType === 'BAR' || selStyleWid.chartProperties.chartType === 'LINE')) || selStyleWid.widgetType === 'TIMESERIES'">
                                    <lib-checkbox formControlName="showTotal" i18n="@@showTotal"
                                        label="Show total count">
                                    </lib-checkbox>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </div>

                <!-- DEFAULT FILTERS -->
                <div class="collapsible">
                    <mat-accordion
                        *ngIf="selStyleWid && (selStyleWid.widgetType === 'TABLE_LIST' || (selStyleWid.field || (selStyleWid.fieldCtrl && !(selStyleWid.fieldCtrl.dataType === 'DTMS' || selStyleWid.fieldCtrl.dataType === 'DATS'))))">
                        <mat-expansion-panel class="mat-elevation-z0" togglePosition="before" expanded="true">
                            <mat-expansion-panel-header expandedHeight="48px" collapsedHeight="48px">
                                <mat-panel-title class="panel-title">
                                    Default filters
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="f-col fields-col">
                                <ng-template [ngIf]="selStyleWid  && selStyleWid.defaultFilters">
                                    <div [formGroup]="defaultFilterCtrlGrp">
                                        <div class="f-row def-algin" formArrayName="filters"
                                            *ngFor="let filter of defaultFilterCtrlGrp.get('filters').controls; let i = index">
                                            <ng-container [formGroupName]="i">
                                                <!-- For Modules -->
                                                <div class="f-col">
                                                    <ng-template
                                                        [ngIf]="styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false">
                                                        <pros-metadatafield-control
                                                            [moduleId]="selStyleWid && selStyleWid.objectType"
                                                            lebel="Field"
                                                            [selectedFldId]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionFieldId"
                                                            (selectionChange)='onDefaultFilterChange($event,i)'
                                                            [isCustomdataset]="selStyleWid && selStyleWid.isCustomdataSet"
                                                            class="field-divider">
                                                        </pros-metadatafield-control>
                                                        <span class="col-spacer"></span>
                                                    </ng-template>

                                                    <!-- For WorkFlow Modules -->
                                                    <ng-template
                                                        [ngIf]="styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true  && styleCtrlGrp.get('isCustomdataSet').value===false">
                                                        <pros-workflowfield-control
                                                            [objectType]="selStyleWid && selStyleWid.objectType"
                                                            label="Field"
                                                            [selectedFldId]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionFieldId"
                                                            (selectionChange)='onDefaultFilterChange($event,i)'
                                                            class="field-divider">
                                                        </pros-workflowfield-control>
                                                        <span class="col-spacer"></span>
                                                    </ng-template>
                                                </div>

                                                <span class="col-spacer"></span>
                                                <!-- select Operators -->
                                                <div class="f-col">
                                                    <pros-udr-condition-operators
                                                        [conditionalOperators]="conditionalOperators"
                                                        [selecetedOperator]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionOperator"
                                                        (afterSelect)="operatorSelectionChng($event,i)"
                                                        class="field-divider">
                                                    </pros-udr-condition-operators>
                                                </div>

                                                <span class="col-spacer"></span>
                                                <div class="f-col">
                                                    <ng-template
                                                        [ngIf]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD_EQUAL'
                                                    || (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD'
                                                    || (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD_GREATETHENEQUAL'
                                                    || (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD_GREATETHAN'
                                                    || (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD_LESSTHEN'
                                                    || (selStyleWid.defaultFilters[i]).conditionOperator==='FIELD2FIELD_LESSTHENEQUALTO'"
                                                        [ngIfElse]="fieldvalue">
                                                        <ng-template
                                                            [ngIf]="styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===false">
                                                            <pros-metadatafield-control
                                                                [moduleId]="selStyleWid && selStyleWid.objectType"
                                                                lebel="Field"
                                                                [selectedFldId]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionFieldEndValue"
                                                                (selectionChange)='onDefaultFilterEndValChange($event,i)'
                                                                [isCustomdataset]="selStyleWid && selStyleWid.isCustomdataSet"
                                                                class="field-divider">
                                                            </pros-metadatafield-control>
                                                            <span class="col-spacer"></span>
                                                        </ng-template>

                                                        <ng-template
                                                            [ngIf]="styleCtrlGrp && styleCtrlGrp.get('isWorkflowdataSet').value===true  && styleCtrlGrp.get('isCustomdataSet').value===false">
                                                            <pros-workflowfield-control
                                                                [objectType]="selStyleWid && selStyleWid.objectType"
                                                                label="Field "
                                                                [selectedFldId]="selStyleWid && selStyleWid.defaultFilters && (selStyleWid.defaultFilters[i]).conditionFieldEndValue"
                                                                (selectionChange)='onDefaultFilterEndValChange($event,i)'
                                                                class="field-divider">
                                                            </pros-workflowfield-control>
                                                        </ng-template>
                                                    </ng-template>

                                                    <ng-template #fieldvalue>
                                                        <div class="f-col value-set">

                                                            <lib-input label="Value"
                                                                formControlName="conditionFieldValue"
                                                                matTooltip="{{selStyleWid.defaultFilters[i].conditionFieldValue ? selStyleWid.defaultFilters[i].conditionFieldValue: ''}}"
                                                                matTooltipPosition="right">
                                                            </lib-input>
                                                        </div>
                                                    </ng-template>
                                                </div>
                                                <span class="col-spacer"></span>
                                                <div class="f-col value-set">

                                                    <lib-button type="plain" icon="minus-circle"
                                                        (click)="removeFilter(i)" matTooltip="Remove"
                                                        matTooltipPosition="right"></lib-button>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>
                                </ng-template>

                                <div class="f-row add-button">
                                    <lib-button (click)="addMoreDefaultFilter()" type="minor">Add</lib-button>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </div>
            </div>
        </div>
    </div>
</div>